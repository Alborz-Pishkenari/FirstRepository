### *********************************************************
### Module: trie.py
### Description: A list and tuple based Python implementation
### of the Trie data structure that supports the following
### methods:
### 1. insert_key(k, v, trie) - insert a non-empty string key k
###    into trie and associate k with value v
### 2. has_key(k, trie) - True if trie has key k
### 3. retrieve_val(k, trie) - retrieve value indexed under key
###    k in trie
### 4. start_with_prefix(prefix, trie) - return the list of
###    all keys in trie that start with prefix.
###
### Bugs, comments to vladimir dot kulyukin at gmail dot com
### *********************************************************

### ***************** HELPER FUNCTIONS **********************

def is_trie_bucket(x):
    return isinstance(x, tuple) and \
           len(x) == 2 and \
           isinstance(x[0], str) and \
           isinstance(x[1], list) and \
           len(x[1]) == 1

def is_trie_branch(x):
    return isinstance(x, list)

def get_bucket_key(b):
    return b[0]

def get_bucket_val(b):
    return b[1][0]

### ******************** INSERT_KEY ************************

def insert_key(k, v, trie):
    ## do not insert empty keys
    if k == '':
        return None
    ## if trie has k or stores it with the same value v,
    ## do not insert
    elif has_key(k, trie) and retrieve_val(k, trie) == v:
        return None
    else:
        tr = trie
        ## for each character c in k, find a child
        ## branch that starts with c
        for c in k:
            branch = find_child_branch(tr, c)
            ## if there is no branch that starts with c,
            ## create it and append it at the end of
            ## the current level.
            if branch == None:
                new_branch = [c]
                tr.append(new_branch)
                tr = new_branch
            else:
                tr = branch
        ## tr is now bound to the branch, so insert
        ## a new bucket.
        tr.append((k,[v]))
        return None

## a branch is either empty or it is a list whose first
## element is a character and the rest are buckets or
## sub-branches.
def get_child_branches(trie):
    if trie == []:
        return []
    else:
        return trie[1:]

def find_child_branch(trie, c):
    for branch in get_child_branches(trie):
       if branch[0] == c:
           return branch
    return None

### ************************ HAS_KEY *************************
      
def has_key(k, trie):
    br = retrieve_branch(k, trie)
    if br == None:
        return False
    else:
        return is_trie_bucket(get_child_branches(br)[0])

### ******************** RETRIEVE_VAL ************************

## find a branch in trie that is indexed under k.
def retrieve_branch(k, trie):
    if k == '':
        return None
    else:
        tr = trie
        for c in k:
            br = find_child_branch(tr, c)
            if br == None:
                return None
            else:
                tr = br
        return tr

## find a branch and retrieve its bucket, second element.
def retrieve_val(k, trie):
    if not has_key(k, trie): return None
    br = retrieve_branch(k, trie)
    return get_bucket_val(br[1])

### *************** START_WITH_PREFIX ************************

def start_with_prefix(prefix, trie):
    ## 1. find the branch indexed by prefix
    br = retrieve_branch(prefix, trie)
    if br == None: return []

    key_list = []
    q = get_child_branches(br)
    ## 2. go through the sub-branches of the
    ## branch indexed by the prefix and
    ## collect the bucket strings into key_list
    while not q == []:
        curr_br = q.pop(0)
        if is_trie_bucket(curr_br):
            key_list.append(get_bucket_key(curr_br))
        elif is_trie_branch(curr_br):
            q.extend(get_child_branches(curr_br))
        else:
            return 'ERROR: bad branch'
    return key_list

### ************************** TESTS **************************

### construct a trie from http://en.wikipedia.org/wiki/Trie
def test_01():
    tr = [[]]
    insert_key('to', 7, tr)
    insert_key('tea', 3, tr)
    insert_key('ted', 4, tr)
    insert_key('ten', 12, tr)
    insert_key('A', 15, tr)
    insert_key('i', 11, tr)
    insert_key('in', 5, tr)
    insert_key('inn', 9, tr)
    return tr

### test start_with_prefix on the trie returned by test_01()
def test_02():
    tr = test_01()
    print start_with_prefix('t', tr)
    print start_with_prefix('te', tr)
    print start_with_prefix('i', tr)


the_tent = '''
abaisser
abandonner
abdiquer
abhorrer
abjurer
abonder
aborder
aboyer
abreuver
abriter
abroger
abréger
absorber
abuser
abîmer
accabler
accaparer
accentuer
accepter
acclamer
accoler
accommoder
accompagner
accorder
accoster
accoter
accoucher
accoupler
accrocher
accréditer
accumuler
accuser
accéder
accélérer
acheminer
acheter
achever
acidifier
acquiescer
acquitter
actionner
activer
actualiser
adapter
additionner
adhérer
adjuger
adjurer
administrer
admirer
admonester
adopter
adorer
adosser
adresser
aduler
affamer
affecter
affectionner
afficher
affiler
affiner
affirmer
affliger
affluer
affoler
affronter
affréter
affubler
affûter
agacer
agencer
agglomérer
agglutiner
aggraver
agiter
agoniser
agrafer
agresser
agripper
agréer
agrémenter
aguicher
aider
aiguiller
aiguillonner
aiguiser
aimanter
aimer
ajourner
ajouter
ajuster
alarmer
alerter
aligner
alimenter
aliéner
allaiter
aller
allier
allonger
allumer
allécher
alléger
alterner
altérer
aléser
amadouer
amalgamer
amarrer
amasser
amender
amener
ameuter
amidonner
amnistier
amorcer
amplifier
amputer
amuser
améliorer
aménager
analyser
ancrer
anesthésier
angliciser
angoisser
animer
annexer
annihiler
annoncer
annoter
annuler
anticiper
antidater
apaiser
apitoyer
apostropher
appareiller
appeler
appliquer
apporter
apposer
apprivoiser
approcher
approuver
approvisionner
apprécier
appréhender
apprêter
appâter
araser
arbitrer
arborer
argenter
argumenter
armer
arracher
arranger
arrimer
arriver
arroser
arrêter
articuler
asceptiser
aseptiser
asperger
asphalter
asphyxier
aspirer
assaisonner
assassiner
assembler
assigner
assimiler
assister
assiéger
associer
assommer
assumer
assurer
assécher
astiquer
attacher
attaquer
attarder
atteler
attenter
atterrer
attester
attirer
attiser
attraper
attribuer
attrister
atténuer
auditionner
augmenter
ausculter
authentifier
automatiser
autoriser
avaler
avancer
avantager
aveugler
aviser
avoisiner
avorter
avouer
axer
aérer
babiller
badigeonner
badiner
bafouer
bafouiller
baguer
baigner
baiser
baisser
balader
balafrer
balancer
balayer
balbutier
baliser
ballotter
bander
baptiser
baratiner
barboter
barbouiller
barrer
barricader
basculer
baser
batifoler
bavarder
baver
bazarder
becqueter
bercer
berner
beugler
beurrer
bichonner
biffer
bifurquer
biseauter
bisser
bivouaquer
blaguer
blaser
blasphémer
blesser
blinder
bloquer
bluffer
blâmer
boiser
boiter
boitiller
bombarder
bomber
bonifier
border
borner
bosseler
bosser
botter
boucher
bouchonner
boucler
bouder
bouffer
bouger
bougonner
bouillonner
bouleverser
boulonner
bouquiner
bourdonner
bourgeonner
bourrer
boursoufler
bousculer
bousiller
boutonner
boxer
boycotter
braconner
brader
brailler
braiser
bramer
brancher
brasser
braver
bredouiller
breveter
bricoler
brider
briguer
briller
brimer
bringuebaler
briquer
briser
broder
bronzer
brosser
brouiller
brouter
broyer
brusquer
brutaliser
brûler
buter
butiner
bâcler
bâfrer
bâiller
bâillonner
bégayer
bénéficier
bétonner
bêcher
bêler
bûcher
cabosser
cacher
cacheter
cadenasser
cadrer
cailler
caillouter
cajoler
calculer
caler
calfater
calibrer
calmer
calomnier
calquer
cambrer
cambrioler
camoufler
camper
canaliser
canoniser
canoter
cantonner
capitaliser
capitonner
capituler
capoter
capter
captiver
capturer
caqueter
caracoler
caractériser
caraméliser
carboniser
carder
caresser
carillonner
carreler
caréner
caser
casser
castrer
cataloguer
catapulter
catéchiser
causer
cautionner
cautériser
ceinturer
censurer
centraliser
centrer
centrifuger
cerner
certifier
cesser
chagriner
chahuter
chamailler
chambarder
chanceler
changer
chanter
chantonner
chaparder
chapeauter
chaperonner
chapitrer
charger
charmer
charrier
chasser
chatouiller
chatoyer
chauffer
chausser
chavirer
chercher
chevaucher
chier
chiffonner
chiffrer
chipoter
chiquer
choquer
choyer
chronométrer
chuchoter
chuinter
châtier
châtrer
cicatriser
ciller
cimenter
cingler
circuler
cirer
cisailler
ciseler
citer
civiliser
claironner
clapoter
claquer
clarifier
classer
classifier
claustrer
clignoter
cliqueter
cloisonner
clouer
clôturer
coasser
cocher
coder
codifier
coffrer
cogner
cohabiter
coiffer
coincer
collaborer
collationner
collecter
collectionner
coller
colmater
coloniser
colorer
colorier
colporter
combiner
combler
commander
commencer
commenter
commercialiser
commuer
communiquer
commémorer
comparer
compenser
compiler
compliquer
comploter
compléter
comporter
composer
composter
comprimer
compter
compulser
concentrer
concerner
concerter
concilier
concorder
concéder
condamner
condenser
conditionner
confectionner
confesser
confier
confiner
confirmer
confisquer
conformer
confronter
conférer
congeler
congestionner
congratuler
congédier
conjecturer
conjuger
conjuguer
conjurer
connecter
consacrer
conseiller
conserver
considérer
consigner
consister
consoler
consolider
consommer
conspirer
conspuer
constater
constituer
consulter
consumer
contacter
contaminer
contempler
contenter
conter
contester
continuer
contourner
contracter
contrarier
contraster
contre-attaquer
contre-balancer
contrecarrer
contrer
contresigner
contribuer
contrôler
converger
converser
convoiter
convoquer
convoyer
coopérer
coordonner
copier
copuler
corriger
corroborer
corroder
coter
coucher
couiner
couler
couper
coupler
courber
couronner
courtiser
couver
coïncider
coûter
cracher
cramponner
craquer
cravacher
creuser
crever
crier
crisper
crisser
cristalliser
critiquer
croasser
crocheter
croiser
croquer
crouler
crucifier
crâner
créer
crépiter
cuisiner
culbuter
culminer
cultiver
cumuler
curer
câbler
câliner
céder
célébrer
dactylographier
daigner
damer
damner
danser
darder
dater
demander
demeurer
dessaler
desserrer
dessiner
dessoûler
dessécher
destiner
destituer
devancer
deviner
deviser
diagnostiquer
dialoguer
dicter
diffamer
diffracter
diffuser
différencier
différer
digérer
dilapider
dilater
diluer
diminuer
diriger
discerner
discipliner
discréditer
disculper
discuter
disloquer
dispenser
disperser
disposer
disputer
disqualifier
disserter
dissimuler
dissiper
dissocier
dissuader
disséminer
disséquer
distancer
distiller
distinguer
distribuer
divaguer
diverger
diversifier
diviniser
diviser
divulguer
domestiquer
dominer
dompter
donner
dorer
dorloter
doser
doter
doubler
douter
draguer
drainer
dramatiser
draper
dresser
dribbler
droguer
duper
durer
déambuler
déballer
débarbouiller
débarquer
débarrasser
débaucher
débiter
déblayer
débloquer
déboiser
déborder
déboucher
débourser
déboutonner
déboîter
débrancher
débrayer
débrouiller
débuter
décacheter
décaler
décalquer
décamper
décaper
décapiter
décapsuler
déceler
décentraliser
décentrer
décerner
décharger
déchausser
déchaîner
déchiffrer
déchirer
décider
décimer
déclarer
déclasser
déclencher
décliner
décocher
décoder
décoiffer
décoincer
décoller
décolorer
décommander
décomposer
déconcerter
décongeler
décongestionner
déconnecter
déconsidérer
décontaminer
décontenancer
décorer
décortiquer
découler
découper
décourager
décrasser
décrocher
décrypter
décréter
déculotter
décéder
dédaigner
dédicacer
dédier
dédoubler
défalquer
déferler
défier
défigurer
défiler
déflorer
défoncer
déformer
défrayer
déférer
dégager
dégainer
dégeler
dégivrer
dégonfler
dégouliner
dégoutter
dégoûter
dégrader
dégrafer
dégraisser
dégringoler
dégriser
déguiser
déguster
dégénérer
déjeuner
déjouer
délacer
délaisser
délasser
délayer
délester
délibérer
délier
délimiter
délivrer
déloger
déléguer
démagnétiser
démanger
démanteler
démarquer
démarrer
démasquer
démembrer
démilitariser
déminer
démissionner
démobiliser
démocratiser
démonter
démontrer
démoraliser
démouler
démâter
déménager
démêler
dénaturer
dénicher
dénier
dénigrer
dénombrer
dénommer
dénoncer
dénoter
dénouer
dénoyauter
dénuder
dépanner
déparer
départager
dépasser
dépayser
dépecer
dépenser
dépeupler
dépister
déplacer
déplier
déplisser
déplorer
déployer
déporter
déposer
déposséder
dépouiller
dépoussiérer
dépraver
déprimer
déprécier
députer
dépêcher
déraciner
déraisonner
déranger
déraper
dératiser
dériver
dérober
déroger
dérouler
dérouter
dérégler
désamorcer
désapprouver
désarmer
désarçonner
désavouer
désembuer
désensibiliser
déserter
désespérer
déshabiller
déshonorer
déshériter
désigner
désinfecter
désintégrer
désirer
désoler
désorganiser
désorienter
désosser
déséquilibrer
détacher
détailler
détecter
dételer
déterminer
déterrer
détester
détoner
détonner
détourner
détraquer
détromper
détrousser
détrôner
détériorer
dévaler
dévaliser
dévaluer
dévaster
développer
déverser
dévider
dévier
dévisager
dévisser
dévoiler
dévorer
dîner
effacer
effarer
effaroucher
effectuer
effiler
effleurer
efforcer
effrayer
emballer
embarquer
embarrasser
embaucher
embaumer
emboîter
embrasser
embrigader
embrouiller
embusquer
embêter
emmagasiner
emmailloter
emmener
emmurer
emménager
emmêler
empailler
empaler
empaqueter
emparer
empeser
empester
empierrer
empiler
empirer
empiéter
employer
empocher
empoigner
empoisonner
emporter
emprisonner
emprunter
empêcher
encadrer
encaisser
encaustiquer
encenser
encercler
enchanter
enchaîner
enchevêtrer
enclaver
enclencher
encoller
encombrer
encourager
encrasser
encrer
endiguer
endoctriner
endommager
endosser
endurer
enfermer
enflammer
enfler
enfoncer
enfourcher
enfourner
enfumer
engager
engendrer
englober
engorger
engouffrer
engraisser
engueuler
enivrer
enjamber
enjoliver
enjôler
enlacer
enlever
ennuyer
enquêter
enrayer
enregistrer
enrouler
enrôler
ensabler
enseigner
ensemencer
ensorceler
entailler
entamer
entasser
enterrer
entonner
entourer
entraver
entraîner
entrelacer
entrelarder
entreposer
entrer
entériner
enumérer
envelopper
envenimer
envier
environner
envisager
envoler
envoyer
envoûter
errer
escalader
escamoter
escompter
escorter
espacer
espionner
espérer
esquinter
esquisser
esquiver
essaimer
essayer
essorer
essouffler
essuyer
estimer
estomper
estropier
exacerber
exagérer
exalter
examiner
exaspérer
exaucer
exceller
excepter
exciper
exciter
exclamer
excommunier
excuser
excéder
exempter
exercer
exhaler
exhiber
exhorter
exhumer
exiger
exiler
exister
exonérer
exorciser
expectorer
expertiser
expier
expirer
expliciter
expliquer
exploiter
explorer
exploser
exporter
exposer
exprimer
exproprier
expulser
expurger
expédier
expérimenter
exterminer
extirper
extorquer
extrader
exténuer
extérioriser
exulter
exécrer
exécuter
fabriquer
faciliter
facturer
falsifier
familiariser
faner
farder
farter
fasciner
fatiguer
faucher
faufiler
fausser
favoriser
façonner
fermenter
fermer
ferrer
fertiliser
festoyer
feuilleter
feutrer
ficeler
ficher
figer
figurer
filer
fileter
filmer
filtrer
financer
fixer
flageller
flageoler
flairer
flamber
flamboyer
flancher
flanquer
flatter
flirter
flotter
flouer
flâner
flécher
foisonner
folâtrer
fomenter
fonctionner
fonder
forcer
forer
forger
former
formuler
fortifier
foudroyer
fouetter
fouiller
fouler
fourmiller
fracasser
fractionner
fracturer
fragmenter
fraiser
franciser
frapper
fraterniser
frauder
frayer
fredonner
freiner
frictionner
frigorifier
friser
frissonner
froisser
froncer
frotter
fructifier
frustrer
fréquenter
fréter
frétiller
fulminer
fumer
fureter
fusiller
fusionner
fustiger
fâcher
féconder
féliciter
fêler
fêter
gaffer
gager
gagner
gainer
galoper
galvaniser
galvauder
gambader
garder
garer
gargouiller
garrotter
gaspiller
gaufrer
gaver
gazer
gazouiller
geler
germer
gesticuler
gifler
gigoter
glacer
glaner
glisser
glorifier
glousser
gober
godiller
gommer
gonfler
goudronner
gouverner
goûter
graduer
graisser
grappiller
gratter
graver
graviter
greffer
grelotter
grever
gribouiller
griffer
griffonner
grignoter
grimer
grimper
grincer
gripper
griser
grisonner
grogner
grommeler
gronder
grouiller
grouper
grésiller
guerroyer
guetter
gueuler
guider
guillotiner
gâcher
gâter
généraliser
gérer
gêner
habiller
habiter
habituer
hacher
haleter
handicaper
hanter
happer
haranguer
harceler
harmoniser
harnacher
harponner
hasarder
hausser
herboriser
heurter
hiberner
hisser
hiverner
hocher
honorer
hoqueter
horrifier
horripiler
hospitaliser
houspiller
huer
huiler
humaniser
humecter
humer
humidifier
humilier
hurler
hypnotiser
hypothéquer
hâter
héberger
héler
hérisser
hésiter
identifier
idolâtrer
idéaliser
ignorer
illuminer
illustrer
imaginer
imbiber
imiter
immatriculer
immerger
immigrer
immobiliser
immoler
immortaliser
immuniser
impatienter
imperméabiliser
implanter
impliquer
implorer
importer
importuner
imposer
impressionner
imprimer
improviser
imprégner
inaugurer
incarcérer
incarner
incendier
incinérer
inciter
incliner
incomber
incommoder
incorporer
incriminer
inculper
indigner
indiquer
indisposer
individualiser
industrialiser
infester
infirmer
infliger
influencer
informatiser
informer
infuser
inférer
ingurgiter
inhumer
injecter
injurier
innocenter
innover
inonder
inquiéter
insensibiliser
insinuer
insister
insonoriser
inspecter
inspirer
installer
instaurer
instituer
insuffler
insulter
insérer
intensifier
intercaler
intercepter
intercéder
interférer
interloquer
interner
interpeller
interposer
interpréter
interroger
interviewer
intimer
intimider
intoxiquer
intriguer
introniser
intégrer
intéresser
intérioriser
invalider
invectiver
inventer
inverser
inviter
invoquer
ironiser
irradier
irriguer
irriter
isoler
jacasser
jalonner
jalouser
japper
jaser
jauger
jeter
jongler
jouer
jubiler
juger
jumeler
jurer
justifier
juxtaposer
kidnapper
klaxonner
labourer
lacer
lacérer
laisser
laminer
lancer
laper
lapider
larder
larguer
larmoyer
lasser
laver
laïciser
lessiver
lester
leurrer
lEver
libéraliser
libérer
licencier
lier
ligaturer
ligoter
limer
limiter
limoger
liquider
liquéfier
lisser
livrer
lober
localiser
loger
longer
lorgner
loucher
louer
louper
louvoyer
lubrifier
lustrer
lutter
lyncher
lâcher
lécher
légaliser
légiférer
léguer
léser
lésiner
maculer
macérer
magnétiser
majorer
malaxer
malmener
maltraiter
mander
manger
manier
manifester
manigancer
manipuler
manoeuvrer
manquer
maquiller
marbrer
marchander
marcher
marier
mariner
marmonner
marmotter
marquer
marteler
martyriser
masquer
massacrer
masser
mastiquer
masturber
matelasser
mater
matraquer
maugréer
maçonner
maîtriser
menacer
mendier
mener
mentionner
mesurer
meubler
meugler
miauler
mijoter
militer
mimer
minauder
miner
miniaturiser
minimiser
minuter
mirer
miroiter
miser
mitrailler
mobiliser
modeler
moderniser
modifier
moduler
modérer
moissonner
molester
monnayer
monologuer
monopoliser
monter
montrer
moquer
moraliser
morceler
mordiller
mortifier
motiver
moucher
mouiller
mouler
mousser
muer
multiplier
murer
murmurer
musarder
museler
muter
mutiler
mystifier
mâcher
mâchonner
mâtiner
mécaniser
mécontenter
méditer
méduser
méfier
mélanger
ménager
mépriser
mériter
mésestimer
métisser
mêler
nager
narguer
narrer
nationaliser
naturaliser
naviguer
navrer
neiger
nettoyer
neutraliser
nicher
nier
niveler
nommer
normaliser
noter
nouer
noyauter
noyer
numéroter
nécessiter
négliger
négocier
objecter
obliger
oblitérer
obnubiler
observer
obstiner
obstruer
obséder
obtempérer
obturer
obvier
occasionner
occulter
occuper
offenser
officialiser
officier
offusquer
ondoyer
onduler
opposer
oppresser
opprimer
opter
opérer
orchestrer
ordonner
organiser
orienter
ornementer
orner
orthographier
osciller
oser
oublier
outiller
outrager
outrepasser
outrer
ovationner
pacifier
pagayer
palabrer
pallier
palper
palpiter
paniquer
panser
papilloter
papoter
parachever
paralyser
parapher
paraphraser
pardonner
parer
paresser
parfumer
parier
parlementer
parler
parodier
parquer
parrainer
partager
participer
passer
passionner
pasteuriser
patauger
patienter
patiner
patronner
patrouiller
paumer
pavoiser
payer
peigner
peiner
peler
pelleter
peloter
pelucher
pencher
penser
percer
percher
percuter
perfectionner
perforer
perler
permuter
perpétrer
perpétuer
perquisitionner
persister
personnaliser
personnifier
persuader
persécuter
persévérer
perturber
peser
pester
peupler
photocopier
photographier
piaffer
piailler
piauler
picorer
picoter
piger
piler
piller
pilonner
piloter
pincer
piocher
piquer
pisser
pivoter
piétiner
placarder
placer
plagier
plaider
plaisanter
planer
planifier
planter
plaquer
plastronner
pleurer
pleurnicher
plier
plisser
plomber
plonger
ployer
plumer
plâtrer
poignarder
pointer
poinçonner
polariser
politiser
polluer
polycopier
pomper
pomponner
poncer
ponctuer
pontifier
populariser
porter
poser
posséder
poster
postillonner
postuler
potasser
poudrer
pourchasser
pousser
pratiquer
presser
pressurer
prier
primer
priser
priver
proclamer
procréer
procurer
procéder
profaner
professer
profiler
profiter
proférer
programmer
progresser
prohiber
projeter
proliférer
prolonger
promener
promulguer
prononcer
propager
prophétiser
proportionner
proposer
propulser
proroger
prospecter
prospérer
protester
protéger
prouver
provoquer
précipiter
préciser
préconiser
précéder
prédominer
préférer
préjuger
prélEver
préméditer
préoccuper
préparer
présager
présenter
préserver
présider
présumer
présupposer
prêcher
prêter
prôner
psalmodier
psychanalyser
publier
pulluler
pulvériser
purger
purifier
pâmer
pécher
pédaler
pénaliser
pénétrer
pépier
péricliter
pérorer
pétarader
péter
pétiller
pétrifier
pêcher
qualifier
quantifier
questionner
quitter
quémander
quêter
rabaisser
raboter
rabrouer
rabâcher
raccommoder
raccompagner
raccorder
raccrocher
racheter
racler
racoler
raconter
radier
radiodiffuser
radiographier
radoter
raffiner
rafistoler
rafler
rager
railler
raisonner
rajuster
rallier
rallonger
rallumer
ramasser
ramener
ramer
ramoner
ramper
ranger
ranimer
rapatrier
rapetasser
rapetisser
rapiécer
rappeler
rappliquer
rapporter
rapprocher
raser
rassasier
rassembler
rassurer
rater
ratifier
rationner
ratisser
rattacher
rattraper
raturer
ravager
ravaler
ravauder
ravigoter
raviner
ravitailler
raviver
rayer
rayonner
rebaptiser
reboiser
rebrousser
rebuter
recaler
receler
recenser
rechaper
recharger
rechercher
rechigner
reclasser
recommander
recommencer
reconsidérer
reconstituer
recouvrer
recracher
recruter
recréer
rectifier
reculer
recycler
redistribuer
redoubler
redouter
redresser
refermer
refluer
refléter
refouler
refréner
refuser
regagner
regarder
regimber
regretter
regrouper
rehausser
rejeter
relancer
relater
relaxer
relayer
relEver
relier
relâcher
reléguer
remailler
remanier
remarier
remarquer
rembarrer
remblayer
rembourrer
rembourser
remercier
remeubler
remonter
remorquer
remplacer
remporter
remuer
remédier
rencontrer
renfermer
renflouer
renforcer
renier
renifler
renoncer
renouer
renouveler
renseigner
rentrer
renverser
renvoyer
renâcler
repasser
repenser
repeupler
replier
reporter
reposer
repousser
repriser
reprocher
représenter
repérer
repêcher
resister
respecter
respirer
ressembler
ressemeler
resserrer
restaurer
rester
retaper
retarder
retirer
retomber
retoucher
retourner
retracer
retrancher
retrousser
retrouver
revaloriser
revendiquer
revigorer
revisser
revitaliser
revivifier
ricaner
ricocher
rider
ridiculiser
rigoler
rimer
rincer
riposter
risquer
rivaliser
river
roder
rogner
romancer
ronchonner
ronfler
ronger
ronronner
ronéotyper
roquer
rosser
roter
roucouler
rougeoyer
rouiller
rouler
roupiller
rouspéter
rudoyer
ruer
ruiner
ruisseler
ruminer
râler
râper
réadapter
réaffirmer
réaliser
réapprovisionner
réarmer
réarranger
récapituler
réchapper
réchauffer
réciter
réclamer
récolter
réconcilier
réconforter
récupérer
récurer
récuser
rédiger
réexpédier
réformer
réfracter
réfrigérer
réfugier
réfuter
régenter
réglementer
régler
régner
régulariser
régénérer
réhabiliter
réintégrer
réitérer
rémunérer
rénover
réorganiser
réparer
répertorier
répliquer
réprimander
réprimer
réprouver
répudier
répugner
répéter
réquisitionner
réserver
résider
résigner
résilier
résister
résonner
réssusciter
résulter
résumer
rétamer
rétribuer
rétrograder
réveiller
réverbérer
réviser
révolter
révolutionner
révoquer
révéler
révérer
réévaluer
rêvasser
rêver
rôder
s'occuper
sabler
saborder
saboter
saccager
sacrer
sacrifier
saigner
saler
saliver
saluer
sanctifier
sanctionner
sangler
sangloter
saper
sarcler
satiriser
saturer
saupoudrer
sauter
sautiller
sauvegarder
sauver
savonner
savourer
scalper
scandaliser
scander
sceller
scier
scintiller
scruter
sculpter
seconder
secouer
sectionner
segmenter
seller
sembler
semer
seriner
serpenter
serrer
sevrer
siffler
siffloter
signaler
signer
signifier
sillonner
simplifier
simuler
singer
singulariser
siphonner
siroter
situer
siéger
skier
soigner
solder
solenniser
solidifier
solliciter
sombrer
sommeiller
sommer
somnoler
sonder
songer
sonner
soucier
souder
soudoyer
souffler
souhaiter
souiller
soulager
soulEver
souligner
soupeser
soupirer
soupçonner
sous-estimer
sous-exposer
sous-louer
soûler
spécifier
spéculer
stabiliser
standardiser
stationner
statuer
stigmatiser
stimuler
stipuler
stocker
stopper
strier
structurer
stupéfier
stériliser
subdiviser
subjuguer
sublimer
submerger
subsister
substantiver
substituer
subventionner
succomber
succéder
sucer
sucrer
suer
suffoquer
suggérer
suicider
suinter
superposer
superviser
supplanter
supplier
suppléer
supporter
supposer
supprimer
suppurer
supputer
surabonder
surajouter
surcharger
surclasser
surcouper
surestimer
surexposer
surimposer
surmonter
surnager
surnommer
surpasser
surplomber
sursauter
surveiller
survoler
surélEver
susciter
suspecter
susurrer
suturer
symboliser
sympathiser
synchroniser
systématiser
sécher
sécréter
séjourner
sélectionner
séparer
séquestrer
sérier
tabler
tacher
tailler
talonner
tambouriner
tamiser
tamponner
tanner
taper
tapisser
tapoter
taquiner
tarabuster
tarauder
tarder
tarifer
tartiner
tasser
tatouer
taxer
teinter
temporiser
tempérer
tempêter
tenter
tergiverser
terminer
terrasser
terrifier
terroriser
tester
thésauriser
tictaquer
timbrer
tinter
tirailler
tirer
tisonner
tisser
titrer
tituber
toiser
tolérer
tomber
tonifier
tonner
torcher
torpiller
torréfier
torsader
tortiller
torturer
totaliser
toucher
tourbillonner
tourmenter
tourner
tournoyer
tousser
tracasser
tracer
trafiquer
traiter
tramer
trancher
tranquilliser
transborder
transfigurer
transformer
transférer
transgresser
transiger
transiter
transpercer
transpirer
transplanter
transporter
transposer
transvaser
traquer
traumatiser
travailler
traverser
traîner
trembler
trembloter
tremper
tressauter
tresser
treuiller
tricher
tricoter
trier
trimbaler
trimer
triompher
tripler
tripoter
triturer
tromper
tronquer
tronçonner
troquer
trotter
trottiner
troubler
trouer
trouver
truquer
trébucher
trépaner
trépasser
trépider
tuer
tutoyer
tyranniser
tâcher
tâter
tâtonner
télescoper
télégraphier
téléguider
téléphoner
téléviser
témoigner
unifier
urbaniser
uriner
user
usiner
usurper
utiliser
vacciner
vaciller
vadrouiller
vagabonder
valider
valser
vanner
vanter
vaporiser
varier
vautrer
veiller
vendanger
venger
ventiler
verrouiller
verser
versifier
vexer
vibrer
vicier
vidanger
vider
vilipender
violenter
violer
virevolter
viser
visionner
visiter
vitrer
vitrifier
vitupérer
vociférer
voguer
voiler
voler
voleter
voltiger
voter
vouer
voyager
voûter
vriller
vulcaniser
vulgariser
végéter
vénérer
vérifier
vêler
zigzaguer
zézayer
ébaucher
ébouillanter
ébranler
ébruiter
ébrécher
écailler
écarteler
écarter
échafauder
échanger
échapper
écharper
échauffer
échelonner
échouer
éclabousser
éclairer
éclater
éclipser
écoeurer
économiser
écoper
écorcer
écorcher
écosser
écouler
écourter
écouter
écraser
écrier
écrouer
écrémer
écumer
édifier
éditer
édulcorer
éduquer
égaler
égaliser
égarer
égayer
égorger
égoutter
égratigner
éjaculer
éjecter
élaborer
élaguer
élancer
électrifier
électriser
électrocuter
élEver
éliminer
éloigner
élucider
éluder
émanciper
émaner
émarger
émasculer
émerger
émerveiller
émietter
émigrer
émonder
émousser
émoustiller
énerver
énoncer
énumérer
épancher
épargner
éparpiller
épater
épauler
épeler
éperonner
épicer
épier
épiler
épingler
épisser
éplucher
épointer
éponger
épouiller
épouser
épousseter
épouvanter
éprouver
épuiser
épurer
équilibrer
équiper
érafler
éreinter
ériger
éroder
éructer
étaler
étamer
étayer
éternuer
étinceler
étiqueter
étirer
étonner
étouffer
étrangler
étriller
étriper
étudier
évacuer
évaluer
évangéliser
évaser
éveiller
éventer
éventrer
évider
évincer
éviter
évoluer
évoquer
ôter

'''

import string

### remove punctuation and '\n' from txt
### and lowercase all characters
def normalize_text(txt):
    ntxt = txt.strip()
    for pc in string.punctuation:
        ntxt = ntxt.replace(pc, ' ')
    ntxt = ntxt.replace('\n', ' ')
    ntxt = ntxt.lower()
    return ntxt

### construct a trie whose keys are words in
### the normalized text of Rumi's poem 'The Tent'
def test_03():
    tent_normalized = normalize_text(the_tent)
    words = tent_normalized.split(' ')
    tr = [[]]
    for w in words:
        insert_key(w, True, tr)
    return tr

### try a few calls with start_with_prefix on
### the trie constructed in test_03()
def test_04():
    tr = test_03()
    print start_with_prefix('th', tr)
    print start_with_prefix('b', tr)
    print start_with_prefix('bl', tr)
    print start_with_prefix('bla', tr)
